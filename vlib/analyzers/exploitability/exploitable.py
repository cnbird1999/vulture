# Jonathan Foote
# jmfoote@loyola.edu
# python exploitable.py /home/user0/fuzzy_stack_research/fuzzy-stack-hash-analysis/bugs/libav/1288206
# find /mnt/hgfs/dev/fuzzy_stack_research/fuzzy-stack-hash-analysis/bugs/ -type d -exec python exploitable.py {} \; &> out.txt
import lib.classifier as classifier
import lib.apport_wrapper as apport_wrapper

def exploitable(path):
    target = apport_wrapper.getTarget(path)
    c = classifier.Classifier().getClassification(target)
    return target, c

if __name__ == "__main__":
    import logging, sys
    path = sys.argv[1]
    try:
        print path
        t, c = exploitable(path)
        print t.current_instruction()
        print c
    except IOError as e:
        print "bad dir probably: %s" % path
        sys.exit(0)
    except Exception as e:
        logging.exception(e)
        raise e

